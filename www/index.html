<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <meta http-equiv="Content-Security-Policy" content="
        default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: gap: content:;
        style-src * 'unsafe-inline';
        script-src * 'unsafe-inline' 'unsafe-eval' https://www.gstatic.com;
        connect-src * https://www.googleapis.com https://securetoken.googleapis.com;
        img-src * 'self' data: https:;
    ">

    <title>Employee Leave Manager</title>
    
    <link rel="stylesheet" href="css/style.css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    <div id="login-screen">
        <div class="login-card">
            <h2 class="login-title">Leave Manager</h2>
            <p class="login-subtitle">Uttarakhand Govt. Employees</p>
            
            <input type="email" id="user-email" class="login-input" placeholder="Email Address">
            <input type="password" id="user-pass" class="login-input" placeholder="Password">
            
            <button class="btn-auth" onclick="emailLogin()">
                Login (‡§≤‡•â‡§ó‡§ø‡§®)
            </button>

            <button class="btn-link" onclick="emailSignup()">
                ‡§®‡§Ø‡§æ ‡§ñ‡§æ‡§§‡§æ ‡§¨‡§®‡§æ‡§è‡§Ç (Register)
            </button>
        </div>
    </div>

    <div id="main-app" style="display: none;">
        
        <header class="dual-gradient-bg">
            <div style="display: flex; justify-content: space-between; align-items: center; padding-bottom: 10px;">
                <div style="flex: 1;">
                    <h2 style="margin:0; font-size:1.5rem; font-weight: 800; letter-spacing: 0.5px;">Leave Manager</h2>
                    <div style="font-size: 0.75rem; opacity: 0.95; margin-top: 2px;">Service Book & Record</div>
                </div>
                <div class="profile-icon-container" onclick="openProfileModal()">
                    <i class="fas fa-user-circle" style="font-size: 1.8rem;"></i>
                </div>
                <div onclick="logoutApp()" style="margin-left: 15px; color: white; cursor: pointer;">
                    <i class="fas fa-sign-out-alt" style="font-size: 1.5rem;"></i>
                </div>
            </div>
            
            <details class="holiday-dropdown" style="margin-top:10px; background:rgba(255,255,255,0.2); border-radius:8px; border:1px solid rgba(255,255,255,0.3);">
                <summary style="padding:10px; font-size:0.9rem; cursor:pointer; color:white; font-weight:bold; display: flex; justify-content: space-between; align-items: center;">
                    <span>üìÖ ‡§Ö‡§µ‡§ï‡§æ‡§∂ ‡§∏‡•Ç‡§ö‡•Ä (Holiday List)</span>
                    <i class="fas fa-chevron-down" style="font-size: 0.8rem;"></i>
                </summary>
                <div class="dropdown-content" style="background:white; color:black; padding:10px; border-radius:0 0 8px 8px; max-height:300px; overflow-y:auto;">
                    <table class="balance-table" style="margin:0;">
                        <thead><tr style="background:#eee;"><th>‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï</th><th>‡§™‡§∞‡•ç‡§µ / ‡§§‡•ç‡§Ø‡•å‡§π‡§æ‡§∞</th></tr></thead>
                        <tbody id="header-holiday-table-body"></tbody>
                    </table>
                </div>
            </details>
        </header>

        <div id="view-calendar" class="app-view">
            <div class="calendar-container" id="calendar-swipe-area">
                <div class="calendar-header dual-gradient-bg" style="border-radius: 12px 12px 0 0; padding: 10px;">
                    <button onclick="changeMonth(-1)">&#10094;</button>
                    <div class="cal-dropdowns" style="display:flex; gap:5px; align-items:center;">
                        <select id="cal-month-select" onchange="jumpToDate()"></select>
                        <select id="cal-year-select" onchange="jumpToDate()"></select>
                    </div>
                    <button onclick="changeMonth(1)">&#10095;</button>
                </div>

                <div class="weekdays"><div>‡§∞‡§µ‡§ø</div><div>‡§∏‡•ã‡§Æ</div><div>‡§Æ‡§Ç‡§ó‡§≤</div><div>‡§¨‡•Å‡§ß</div><div>‡§ó‡•Å‡§∞‡•Å</div><div>‡§∂‡•Å‡§ï‡•ç‡§∞</div><div>‡§∂‡§®‡§ø</div></div>
                <div class="calendar-grid" id="calendar-days"></div>
            </div>
            
            <div class="info-card">
                <h4 style="color:#4e54c8; border-bottom:1px solid #eee; margin:0 0 10px 0; padding-bottom:5px;">
                    <i class="fas fa-info-circle"></i> ‡§á‡§∏ ‡§Æ‡§æ‡§π ‡§ï‡•á ‡§Ö‡§µ‡§ï‡§æ‡§∂
                </h4>
                <ul id="month-holiday-list" class="holiday-list-style"></ul>
            </div>
        </div>

        <div id="view-manager" class="app-view" style="display:none;">
            <div style="text-align:center; padding:15px; margin: 10px;">
                <select id="dashboard-year-select" onchange="updateDashboardYear()" style="padding:8px 20px; border-radius:20px; font-weight:bold; color:#1a237e; border: 2px solid #3949ab;"></select>
            </div>

            <div class="card-box">
                <h4 style="color:#4e54c8; margin:0 0 10px 0;">‡§Ö‡§≤‡•ç‡§™‡§ï‡§æ‡§≤‡•Ä‡§® ‡§Ö‡§µ‡§ï‡§æ‡§∂ (Short Term)</h4>
                <table class="balance-table">
                    <thead><tr><th style="text-align:left;">‡§Ö‡§µ‡§ï‡§æ‡§∂</th><th>‡§ï‡•Å‡§≤</th><th>‡§â‡§™‡§≠‡•ã‡§ó</th><th>‡§∂‡•á‡§∑</th><th>Manage</th></tr></thead>
                    <tbody id="balance-body-short"></tbody>
                </table>
            </div>

            <div class="card-box">
                <h4 style="color:#c0392b; margin:0 0 10px 0;">‡§¶‡•Ä‡§∞‡•ç‡§ò‡§ï‡§æ‡§≤‡•Ä‡§® ‡§Ö‡§µ‡§ï‡§æ‡§∂ (Long Term)</h4>
                <table class="balance-table">
                    <thead><tr><th style="text-align:left;">‡§Ö‡§µ‡§ï‡§æ‡§∂</th><th>‡§ï‡•Å‡§≤</th><th>‡§â‡§™‡§≠‡•ã‡§ó</th><th>‡§∂‡•á‡§∑</th><th>Manage</th></tr></thead>
                    <tbody id="balance-body-long"></tbody>
                </table>
            </div>
            
            <div class="card-box">
                <h4 style="color:#333; margin:0 0 10px 0;">‡§Ö‡§µ‡§ï‡§æ‡§∂ ‡§á‡§§‡§ø‡§π‡§æ‡§∏</h4>
                <ul id="dashboard-history-list" class="holiday-list-style"></ul>
            </div>
        </div>

        <div id="view-dob" class="app-view" style="display:none; padding:15px;">
            <div class="card-box">
                <h3><i class="fas fa-birthday-cake"></i> ‡§Ü‡§Ø‡•Å ‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§ü‡§∞</h3>
                <label class="input-label">‡§ú‡§®‡•ç‡§Æ ‡§§‡§ø‡§•‡§ø:</label>
                <input type="date" id="dob-input">
                <label class="input-label" style="margin-top:10px;">‡§ó‡§£‡§®‡§æ ‡§§‡§ø‡§•‡§ø:</label>
                <input type="date" id="dob-target">
                <button class="btn-save" onclick="calculateAge()">‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡•á‡§Ç</button>
                <div style="text-align:center; margin-top:20px; padding:15px; background:#f3e5f5; border-radius:8px;">
                    <h2 id="age-text" style="margin:0; color:#4a148c;">-</h2>
                </div>
            </div>
        </div>

        <div id="view-notes" class="app-view" style="display:none; padding:10px;">
            <div class="card-box">
                <input type="text" id="note-title" placeholder="‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï (Title)">
                <textarea id="note-text" placeholder="‡§Ø‡§π‡§æ‡§Å ‡§®‡•ã‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç..." style="margin-top:10px;"></textarea>
                <button class="btn-save" onclick="addNote()">Save Note</button>
            </div>
            <div id="notes-list" style="padding:5px;"></div>
        </div>

        <div class="navbar">
            <button class="nav-btn active-nav" onclick="switchTab('view-calendar')">
                <i class="fas fa-calendar-alt"></i><br>‡§ï‡•à‡§≤‡•á‡§Ç‡§°‡§∞
            </button>
            <button class="nav-btn" onclick="switchTab('view-manager')">
                <i class="fas fa-file-invoice"></i><br>Leave A/C
            </button>
            <button class="nav-btn" onclick="switchTab('view-dob')">
                <i class="fas fa-calculator"></i><br>‡§Ü‡§Ø‡•Å
            </button>
            <button class="nav-btn" onclick="switchTab('view-notes')">
                <i class="fas fa-sticky-note"></i><br>‡§®‡•ã‡§ü‡•ç‡§∏
            </button>
        </div>
    </div>

    <div id="ledgerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div><h3 id="modal-leave-name" style="margin:0;">Leave</h3><small id="modal-sub-info">Details</small></div>
                <span class="close-btn" onclick="closeLedgerModal()">&times;</span>
            </div>
            
            <div class="ledger-action-panel">
                <div class="modal-tabs">
                    <button id="tab-debit" class="action-tab active-tab" onclick="switchActionTab('debit')">‡§π‡§ø‡§∏‡§æ‡§¨ (Ledger)</button>
                    <button id="tab-credit" class="action-tab" onclick="switchActionTab('credit')">‡§ï‡•ã‡§ü‡§æ (Credit)</button>
                </div>

                <div id="form-debit">
                    <div style="display:flex; gap:10px;">
                        <div style="flex:1;"><label class="input-label">‡§ï‡§¨ ‡§∏‡•á:</label><input type="date" id="action-start"></div>
                        <div style="flex:1;"><label class="input-label">‡§ï‡§¨ ‡§§‡§ï:</label><input type="date" id="action-end"></div>
                    </div>
                    <button class="btn-save" style="margin-top:15px;" onclick="submitLeaveEntry()">‡§Ö‡§µ‡§ï‡§æ‡§∂ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç</button>
                </div>

                <div id="form-credit" style="display:none;">
                    <div id="credit-container"></div> </div>
            </div>

            <div style="flex:1; overflow:auto; padding:10px; background:#fafafa;">
                <table class="service-book-table">
                    <thead id="sb-thead"></thead>
                    <tbody id="sb-tbody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="profileModal" class="modal">
        <div class="modal-content" style="padding:15px;"></div>
    </div>

    <div id="pratikarModal" class="modal">
        <div class="modal-content" style="padding:15px;"></div>
    </div>

    <script src="cordova.js"></script>
    <script src="main.js" type="module"></script>

</body>
</html>